---
layout: default
title: OpenVpn
tags: 杂项

---

# Openvpn

创建时间: 2014/03/15 11:39:14  修改时间: 2016/12/05 23:54:03 作者:lijiao

----

## 摘要

## OpenVpn

### 编译安装

	下载源码，按照README指示进行即可。Client和Server使用的是同一套源码。

生成PKI和证书

	下载easyrsa，按照README的指示进行即可
	./easyrsa init-pki
	./easyrsa build-ca
	./easyrsa gen-req Server
	./easyrsa sign-req client Server
	./easyrsa gen-req Client
	./easyrsa sign-req client Server
	./easyrsa gen-dh

Server端需要具有的证书:

	ca.crt    ca证书
	server.key Server的私钥
	server.crt Server的证书
	dh.pem     密钥交换

Client端需要具有的证书:

	ca.crt    ca证书(与Server的相同)
	server.key Client的私钥
	server.crt Client的证书

配置Server端:

	复制openvpn的源码目录下sample中Server端配置样例,
	/openvpn-2.3.2/sample/sample-config-files/server.conf 
	
	local 192.168.88.133   #openvpn使用的本地通信IP,可选
	port 1194              #openvpn使用的通信端口
	proto udp              #openvpn使用的通信协议
	dev  tun               #tun: 路由模式  tap: 桥接模式
	ca ca.crt              #ca证书
	cert Server.crt        #Server端证书
	key  Server.key        #Server端私钥 
	dh   dh.pem            #密钥交换证书
	server 10.8.0.0 255.255.255.0  #vpn内部网段
	ifconfig-pool-persist ipp.txt  #在ipp.txt中记录client在vpn内IP分配情况
	
配置Client端:

	复制openvpn的源码目录下sample中Server端配置样例,
	/openvpn-2.3.2/sample/sample-config-files/client.conf 

	client                      #client端
	dev tun
	proto udp
	remote 192.168.88.133 1194  #Server端地址
	resolv-retry infinite       #持续联系Server
	nobind                      #Client端不绑定通信端口
	;http-proxy-retry
	;http-proxy [IP] [port]     #通过代理连接vpn
	ca ca.crt
	cert Client.crt
	key  Client.key
	ns-cert-type server         #只验证类型为server的证书
	
启动
	
	openvpn --config Server.conf
	openvpn --config Client.conf

## 文献
1. http://xxx  "Name"
